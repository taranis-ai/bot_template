_min_copier_version: "9.0"
# instructs copier to copy and render every file
_templates_suffix: ""

project_name:
  type: str
  help: Project Name

dir_name:
  default: "{{ project_name.replace(' ', '-') | lower }}"
  when: false
  type: str

package_name:
  default: "{{ project_name.lower().replace(' ', '_').replace('-', '_') | lower }}"
  when: false
  type: str

image_name:
  default: "taranis-{{ project_name.lower().replace(' ', '-').replace('_', '-') }}"
  when: false
  type: str

models:
  type: str
  help: Different models used in your project (comma-separated list, e.g. model_a, model_b)

author_mail:
  type: str
  default: "(author@ait.ac.at) "
  help: Your E-Mail

description:
  type: str
  default: "(A short description of what the bot does) "
  help: Description

repo_url:
  type: str
  default: ""
  help: Github URL

init_git_repo:
  type: bool
  default: false
  help: Initialize git repo?

_exclude:
  - hooks/
  - ruff.toml
  - .pre-commit-config.yaml
  - .gitignore
  - .git/
  - copier.yml

_tasks:
  - command: >
      cd "{{ _copier_conf.dst_path }}/{{ dir_name }}" &&
      git init -b main
    when: "{{ init_git_repo }}"

  - command: >
      cd "{{ _copier_conf.dst_path }}/{{ dir_name }}" &&
      git remote add origin
      "{{ repo_url | replace('http://','git@')
                   | replace('https://','git@')
                   | replace('github.com/','github.com:') }}.git"
    when: "{{ init_git_repo }}"
  - command:
      - "{{ _copier_python }}"
      - "{{ pathjoin(_copier_conf.src_path, 'hooks', 'post_create_hook.py', mode='native') }}"
      - "{{ dir_name }}"
      - "{{ models }}"
      - "{{ repo_url }}"
      - "{{ init_git_repo }}"
    when: "{{ _copier_operation == 'copy' }}"